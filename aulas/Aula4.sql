AULA 4 - 24/09/24
REVISÃO CP

PASSO 1 - APAGANDO AS TABELAS
A OPÇÃO CASCADE CONSTRAINTS, ELIMINA AS CHAVES ESTRANGEIRAS (FKS) PARA DEPOIS 
ELIMINAR AS TABELAS

DROP TABLE CLIENTE CASCADE CONSTRAINTS;
DROP TABLE DVD CASCADE CONSTRAINTS;
DROP TABLE FILME CASCADE CONSTRAINTS;
DROP TABLE ATOR CASCADE CONSTRAINTS;
DROP TABLE CATEGORIA CASCADE CONSTRAINTS;
DROP TABLE FILME_ATOR CASCADE CONSTRAINTS;
DROP TABLE LOCACAO CASCADE CONSTRAINTS;

PASSO 2 - CRIANDO AS TABELAS

COMEÇE PELAS QUE NÃO POSSUAM FK
DEPOIS POR AQUELAS QUE TENHAM FK NA CARDINALIDADE DE 1 - N
E POR ÚLTIMO AS ASSOCIATIVAS, RELACIONAMENTOS DE N - N

CREATE TABLE CATEGORIA (
CODCATEG NUMBER(4) PRIMARY KEY,
DESCRICAO VARCHAR(50) NOT NULL);

CREATE TABLE CLIENTE (
CODCLI NUMBER(4) PRIMARY KEY,
PRENOME VARCHAR(50) NOT NULL,
SOBRENOME VARCHAR(50),
ENDERECO VARCHAR(70),
TELEFONE VARCHAR(20));

CREATE TABLE ATOR (
CODATOR NUMBER(4) PRIMARY KEY,
NOME_POPULAR VARCHAR(50) NOT NULL,
NOME_ARTISTICO VARCHAR(50),
DATANASC DATE);

CREATE TABLE FILME (
CODFILME NUMBER(4) PRIMARY KEY,
TITULO VARCHAR(70) NOT NULL,
CODCAT REFERENCES CATEGORIA);

CREATE TABLE DVD (
NUMDVD NUMBER(4) PRIMARY KEY,
CODFILME REFERENCES FILME,
TIPO CHAR(1));

CREATE TABLE FILME_ATOR (
CODATOR REFERENCES ATOR,
CODFILME REFERENCES FILME);

CREATE TABLE LOCACAO (
CODCLIE REFERENCES CLIENTE,
NUMDVD REFERENCES DVD,
DATARET DATE, DATADEV DATE);

INSERINDO DADOS

SEGUIR A MESMA IDEIA DA CRIAÇÃO DAS TABELAS

INSERT INTO CATEGORIA VALUES (1, 'Comédia');
INSERT INTO CATEGORIA VALUES (2, 'Drama');
INSERT INTO CATEGORIA VALUES (3, 'Aventura');
INSERT INTO CATEGORIA VALUES (4, 'Terror');

INSERT INTO CLIENTE VALUES (1, 'João', 'Silva', 'Rua da Cruz sem Pé', '4444-1111');
INSERT INTO CLIENTE VALUES (2, 'Antônio', 'Ferreira', 'Av. da Vila Velha', '6660-9333');
INSERT INTO CLIENTE VALUES (3, 'Fabio', 'Dias', 'Rua Antonio Vieira', '2337-0393');
INSERT INTO CLIENTE VALUES (4, 'Andreia', 'Melo', 'Rua da Praia Bonita', '8989-7777');
INSERT INTO CLIENTE VALUES (5, 'Murilo', 'Fontes', 'Av. dos Autonomistas', '9090-9090');

INSERT INTO ATOR VALUES(10, 'João Carlos', 'Rambo', '10-jan-79');
INSERT INTO ATOR VALUES(11, 'Marta Valéria', 'Mulher Mara', '16-oct-82');
INSERT INTO ATOR VALUES(12, 'Ricardo Jones', 'Elvis', '7-dec-88');

INSERT INTO FILME VALUES(1, 'Sai pra lá', 1);
INSERT INTO FILME VALUES(2, 'Ajuda Eterna', 2);
INSERT INTO FILME VALUES(3, 'Anjos Malditos', 2);
INSERT INTO FILME VALUES(4, 'Pânico II', 4);
INSERT INTO FILME VALUES(5, 'Um dia de furia', 3);
INSERT INTO FILME VALUES(6, 'Lente Cega', 3);
INSERT INTO FILME VALUES(7, 'Sinais do Tempo', 2);
INSERT INTO FILME VALUES(8, 'A melodia da vida', 1);

INSERT INTO DVD VALUES(1, 1, 'S');
INSERT INTO DVD VALUES(2, 1, 'S');
INSERT INTO DVD VALUES(3, 1, 'S');
INSERT INTO DVD VALUES(4, 2, 'D');
INSERT INTO DVD VALUES(5, 3, 'S');

INSERT INTO FILME_ATOR VALUES(10,1);
INSERT INTO FILME_ATOR VALUES(11,2);
INSERT INTO FILME_ATOR VALUES(12,3);

INSERT INTO LOCACAO VALUES(1,1,'05-jan-84','07-jan-84');
INSERT INTO LOCACAO VALUES(2,2,'13-jun-00','15-jun-00');
INSERT INTO LOCACAO VALUES(3,3,'22-oct-22','24-oct-22');

QUESTÃO 3 - ALTERE O NÚMERO DA CATEGORIA COMÉDIA DE 01 PARA 08 NA TABELA CATEGORIA.

UPDATE CATEGORIA SET CODCATEG = 8 WHERE CODCATEG = 1;
NÃO REALIZA PQ O VALOR 1 ESTÁ SENDO USADO NA FK DA TABELA FILME

SELECT * FROM FILME;
UPDATE FILME SET CODCAT = NULL WHERE CODCAT = 1;
SELECT * FROM CATEGORIA;
UPDATE CATEGORIA SET CODCATEG = 8 WHERE CODCATEG = 1;
UPDATE FILME SET CODCAT = 8 WHERE CODCAT IS NULL;

QUESTÃO 4
INSIRA A COLUNA SINOPSE NA TABELA FILME COM 300 CARACTERES.
ALTER TABLE FILME ADD SINOPSE VARCHAR(300);

QUESTÃO 5
CADASTRE UMA NOVA CATEGORIA DE FILME CHAMADA FICÇÃO.
INSERT INTO CATEGORIA VALUES (5, 'Ficção');

QUESTÃO 6
APAGUE O FILME CHAMADO “ANJOS MALDITOS” E “A MELODIA DA VIDA” DA TABELA FILME. PARA
ISSO, UTILIZE UM ÚNICO COMANDO.

CRIANDO RELATÓRIOS

SINTAXE - SELECT * FROM TABLE_NAME;
* - SIGNIFICA TODAS AS COLUNAS DE UMA TABELA

SINTAXE - SELECT COLUMN_NAME1, COLUMN_NAME2,..... FROM TABLE_NAME;

NOSSO SISTEMA
DROP TABLE CLIENTE CASCADE CONSTRAINTS;
DROP TABLE VENDEDOR CASCADE CONSTRAINTS;
DROP TABLE PRODUTO CASCADE CONSTRAINTS;
DROP TABLE PEDIDO CASCADE CONSTRAINTS;
DROP TABLE ITEM_PEDIDO CASCADE CONSTRAINTS;

CREATE TABLE CLIENTE
(COD_CLIE NUMBER(4) CONSTRAINT CLIE_CD_PK PRIMARY KEY,
NOME_CLIE VARCHAR2(20) CONSTRAINT CLIE_NO_NN NOT NULL,
ENDERECO VARCHAR2(30),CIDADE VARCHAR2(15),
CEP CHAR(8),UF CHAR(2),CNPJ CHAR(17),IE CHAR(12));

CREATE TABLE VENDEDOR
(COD_VEN NUMBER(4) CONSTRAINT VEN_COD_PK PRIMARY KEY,
NOME_VEN VARCHAR2(20) CONSTRAINT VEN_NO_NN NOT NULL,
SALARIO_FIXO NUMBER(12,2),COMISSAO CHAR(1));

CREATE TABLE PRODUTO
(COD_PROD NUMBER(4) CONSTRAINT PRO_COD_PK PRIMARY KEY,
UNIDADE VARCHAR2(3),DESCRICAO VARCHAR2(30),VAL_UNIT NUMBER(10,2));

CREATE TABLE PEDIDO
(NUM_PEDIDO NUMBER(4) CONSTRAINT PEDIDO_NUM_PK PRIMARY KEY,
PR_ENTREGA NUMBER(3) CONSTRAINT ENTREGA_PR_NN NOT NULL,
COD_CLIE REFERENCES CLIENTE,COD_VEN REFERENCES VENDEDOR);

CREATE TABLE ITEM_PEDIDO
(NUM_PEDIDO REFERENCES PEDIDO,
COD_PROD REFERENCES PRODUTO,
QUANT NUMBER(10,2));

INSERT INTO CLIENTE VALUES(720,'Ana','Rua 17 n.19','Niteroi','24358310','RJ','12113231/0001-34','2134');
INSERT INTO CLIENTE VALUES(870,'Flavio','Av. Pres. Vargas, 10','Sao Paulo','22763931','SP','22534126/9387-9','4631');
INSERT INTO CLIENTE VALUES(110,'Jorge','Rua Caiapo, 13','Curitiba','30078500','PR','14512764/9834-9',NULL);
INSERT INTO CLIENTE VALUES(222,'Lucia','Rua Itabira, 123','Belo Horizonte','22124391','MG','283152123/9348-8','2985');
INSERT INTO CLIENTE VALUES(830,'Mauricio','Av. Paulista, 1236','Sao Paulo','3012683','SP','32816985/7465-6','9343');
INSERT INTO CLIENTE VALUES(130,'Edmar','Rua da Praia, s/n','Salvador','30079300','BA','23463284/234-9','7121');
INSERT INTO CLIENTE VALUES(410,'Rodolfo','Largo da Lapa, 27','Rio de Janeiro','30078900','RJ','12835128/2346-9','743');
INSERT INTO CLIENTE VALUES(20,'Beth','Av. Climerio, 45','Sao Paulo','25679300','SP','32485126/7326-8','9280');
INSERT INTO CLIENTE VALUES(157,'Paulo','Trav. Moraes, casa 3','Londrina',NULL,'PR','32848223/324-2','1923');
INSERT INTO CLIENTE VALUES(180,'Livio','Av. Beira Mar, 1256','Florianopolis','30077500','SC','12736571/2347-4','1111');
INSERT INTO CLIENTE VALUES(260,'Susana','Rua Lopes Mandes, 12','Niteroi','30046500','RJ','21763571/232-9','2530');
INSERT INTO CLIENTE VALUES(290,'Renato','Rua Meireles, 123','Sao Paulo','30225900','SP','13276571/1231-4','1820');
INSERT INTO CLIENTE VALUES(390,'Sebastiao','Rua da Igreja, 10','Uberaba','30438700','MG','32176547/213-3','9071');
INSERT INTO CLIENTE VALUES(234,'Jose','Quadra 3, Bl. 3, sl. 1003','Brasilia','22841650','DF','21763576/1232-3','2931');

INSERT INTO VENDEDOR VALUES(209,'Jose','1800','C');
INSERT INTO VENDEDOR VALUES(111,'Carlos','2490','A');
INSERT INTO VENDEDOR VALUES(11,'Joao','2780','C');
INSERT INTO VENDEDOR VALUES(240,'Antonio','9500','C');
INSERT INTO VENDEDOR VALUES(720,'Felipe','4600','A');
INSERT INTO VENDEDOR VALUES(213,'Jonas','2300','A');
INSERT INTO VENDEDOR VALUES(101,'Joao','2650','C');
INSERT INTO VENDEDOR VALUES(310,'Josias','870','B');
INSERT INTO VENDEDOR VALUES(250,'Mauricio','2930','B');

INSERT INTO PRODUTO VALUES ('25','KG','Queijo',0.97);
INSERT INTO PRODUTO VALUES ('31','BAR','Chocolate',0.87);
INSERT INTO PRODUTO VALUES ('78','L','Vinho',2.00);
INSERT INTO PRODUTO VALUES ('22','M','Linho',0.11);
INSERT INTO PRODUTO VALUES ('30','SAC','Acucar',0.30);
INSERT INTO PRODUTO VALUES ('53','M','Linha',1.80);
INSERT INTO PRODUTO VALUES ('13','G','Ouro',6.18);
INSERT INTO PRODUTO VALUES ('45','M','Madeira',0.25);
INSERT INTO PRODUTO VALUES ('87','M','Cano',1.97);
INSERT INTO PRODUTO VALUES ('77','M','Papel',1.05);

INSERT INTO PEDIDO VALUES ('121','20','410','209');
INSERT INTO PEDIDO VALUES ('97','20','720','101');
INSERT INTO PEDIDO VALUES ('101','15','720','101');
INSERT INTO PEDIDO VALUES ('137','20','720','720');
INSERT INTO PEDIDO VALUES ('148','20','720','101');
INSERT INTO PEDIDO VALUES ('189','15','870','213');
INSERT INTO PEDIDO VALUES ('104','30','110','101');
INSERT INTO PEDIDO VALUES ('203','30','830','250');
INSERT INTO PEDIDO VALUES ('98','20','410','209');
INSERT INTO PEDIDO VALUES ('143','30','20','11');
INSERT INTO PEDIDO VALUES ('105','30','180','240');
INSERT INTO PEDIDO VALUES ('111','15','260','240');
INSERT INTO PEDIDO VALUES ('103','20','260','11');
INSERT INTO PEDIDO VALUES ('91','20','260','11');
INSERT INTO PEDIDO VALUES ('138','20','260','11');
INSERT INTO PEDIDO VALUES ('108','15','290','310');
INSERT INTO PEDIDO VALUES ('119','30','390','250');

INSERT INTO ITEM_PEDIDO VALUES ('121','25','10');
INSERT INTO ITEM_PEDIDO VALUES ('121','31','35');
INSERT INTO ITEM_PEDIDO VALUES ('97','77','20');
INSERT INTO ITEM_PEDIDO VALUES ('101','31','9');
INSERT INTO ITEM_PEDIDO VALUES ('101','78','18');
INSERT INTO ITEM_PEDIDO VALUES ('101','13','5');
INSERT INTO ITEM_PEDIDO VALUES ('98','77','5');
INSERT INTO ITEM_PEDIDO VALUES ('148','45','8');
INSERT INTO ITEM_PEDIDO VALUES ('148','31','7');
INSERT INTO ITEM_PEDIDO VALUES ('148','77','3');
INSERT INTO ITEM_PEDIDO VALUES ('148','25','10');
INSERT INTO ITEM_PEDIDO VALUES ('148','78','30');
INSERT INTO ITEM_PEDIDO VALUES ('104','53','32');
INSERT INTO ITEM_PEDIDO VALUES ('203','31','6');
INSERT INTO ITEM_PEDIDO VALUES ('189','78','45');
INSERT INTO ITEM_PEDIDO VALUES ('143','31','20');
INSERT INTO ITEM_PEDIDO VALUES ('143','78','10');

COMMIT;